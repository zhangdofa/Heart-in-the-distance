<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
	<title></title>
	<script type="text/javascript" src="/thinkphp/public/buycar/jquery-3.3.1.min.js"></script>
	<!-- <script type="text/javascript" src="jquery.cookie.js"></script> -->
	<style type="text/css">
		.login1{
			border: 1px;
			background-color: #ffffff;
			height: 240px;
			width: 400px;
			clear: both;
			text-align: center;
		}
		.register1{
			border: 1px;
			background-color: #ffffff;   
			width: 400px;
			height: 240px;
			display: none;
			text-align: center;
			clear: both;
		}
    .updatepwd{
      border: 1px;
      background-color: #ffffff;   
      width: 400px;
      height: 240px;
      text-align: center;
      display: none;
      clear: both;
    }
    .updatepwd1{
      border: 1px;
      background-color: #ffffff;   
      width: 400px;
      height: 240px;
      text-align: center;
      display: none;
      clear: both;
    }
		.div1{
			 /* margin-top: 200px;
			 			margin-left: 550px; */
			margin:0 auto;
			position: absolute;
			top: 30%;
			left: 40%;  
            background-color: #ffffff;
            width: 400px;
            text-align: center;
            border-radius:5px;
            opacity: 0.8;
		}
		.line{
			/* text-decoration:underline;
			 color:red; */
			 border-bottom:1px solid red;
			 color: red;
		}
	</style>
	<!-- <script>
           $(document).ready(function(){
               var rem = $.cookie('remember');
               if(rem){
                 alert("账号密码将自动填充");
                   $(".remember").prop("checked",true);
                   $(".user").val($.cookie("user"));
                   $(".password").val($.cookie("password"));
               }
           });
       </script>  -->
</head>
<body style="background-image: url(/thinkphp/public/img/test1.jpg);background-repeat: no-repeat;background-size: 100%,100%;">
	<div class="div1" >
         <div class="login"  style="width: 200px;height: 30px;float: left; border-bottom:1px solid red;">登录</div>

         <div class="register"  style="width: 200px;height: 30px;float: right;">注册</div>    
    	<div class="login1" align="center" style="background-image: url(/thinkphp/public/img/hh.gif);background-repeat: no-repeat;">
    	<p>用户登录</p>
      	<div>请输入用户名<input type="text" name="" class="user" placeholder="请输入6-16位字母或数字"></div>
      	<div class="aaa" style="font-size: small;color: red;height: 20px;"></div>
      	<div>&nbsp;&nbsp;&nbsp;请输入密码<input type="password" name="" class="password" placeholder="请输入6位数字"></div>
      	<div class="bbb" style="font-size: small;color: red;height: 20px;"></div>
      	<div>是否记住密码<input type="checkbox" name="" class="remember"></div><br>
      	<label style="color: red" class="forget">忘记密码？</label><input type="button" name="" value="登录" class="button" style="background-color: #A0A0A0;">
      </div>

      <div class="register1" align="center" style="background-image: url(/thinkphp/public/img/hh.gif);background-repeat: no-repeat;">
      	<p>用户注册</p>
      	<div>请输入用户名<input type="text" name="" class="user1" placeholder="请输入6-16位字母或数字"></div>
      	<div class="aaa" style="font-size: small;color: red;height: 20px;"></div>
      	<div>&nbsp;&nbsp;&nbsp;请输入密码<input type="password" name="" class="password1" placeholder="请输入6位数字"></div>
      	<div class="bbb" style="font-size: small;color: red;height: 20px;"></div>
        <div style="margin-bottom: 20px;">&nbsp;&nbsp;&nbsp;请输入邮箱<input type="text" name="" placeholder="请输入您的邮箱" class="mail"></div>
      	<input type="button" name="" value="注册" class="registe" style="background-color: #A0A0A0;">
      </div>

       <div class="updatepwd" align="center" style="background-image: url(/thinkphp/public/img/hh.gif);background-repeat: no-repeat;">
        <p>修改密码</p>
        <div>请输入用户名<input type="text" name="" class="user2" placeholder="请输入您的账号"></div>
        <div class="aaa" style="font-size: small;color: red;height: 20px;"></div>
        <div class="mail" style="margin-bottom: 20px;">&nbsp;&nbsp;&nbsp;请输入邮箱<input type="text" name="" placeholder="请输入您的邮箱" class="mail1"></div>
        <input type="button" name="" value="确认" class="query" style="background-color: #A0A0A0;">
      </div>

      <div class="updatepwd1" align="center" style="background-image: url(/thinkphp/public/img/hh.gif);background-repeat: no-repeat;">
        <p>修改密码</p>
        <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请输入新的密码<input type="text" name="" class="password2" placeholder="请输入您的密码"></div>
        <div class="aaa" style="font-size: small;color: red;height: 20px;"></div>
        <div class="mail" style="margin-bottom: 20px;">&nbsp;&nbsp;&nbsp;请再一次输入密码<input type="text" name="" placeholder="请确认您的密码" class="password3"></div>
        <input type="button" name="" value="确认" class="query1" style="background-color: #A0A0A0;">
      </div>
    </div>
    <script type="text/javascript">
    	$(".register").click(function(){
    	   $(".register").addClass('line');
    	   $(".login").removeClass('line');
         $(".login").css('border-bottom','');
    	   $(".login1").css('display','none');
           $(".register1").css('display','block');
           /*var index=$(this).index();
           $(".register1").hide();
           $(".register1").eq(index).show();*/
    	})
    	$(".login").click(function(){
    		$(".login").addClass('line');
            $(".register").removeClass('line');
    		$(".register1").css('display','none');
    		$(".login1").css('display','block');
    	})

    	 $(".user").focus(function(event) {
      	   	/* Act on the event */
              $(this).css("background-color","yellow");
      	   })
      	   $(".user").blur(function () {
              $(this).css("background-color","");
              var user1=$(".user").val();
              var re=/^[a-zA-Z][a-zA-Z0-9]{6,16}$/;
              if (re.test(user1)) {
              } else {
              	
              $(".aaa").html("*用户名为6-16位字母或数字，首位为字母");
              }
      	   })
      	  $(".password").focus(function () {
      	   	$(this).css("background-color","yellow");
      	   })
      	   $(".password").blur(function(event) {
      	   	/* Act on the event */
      	   	var password=$(".password").val();
      	   	var re=/^\d{6}$/;
      	   	if (re.test(password)) {
      	   	} else {
      	   		$(".bbb").html("*密码为6位数字");
      	   		$(this).css("background-color","");
      	   	}
      	   })

          $('.forget').click(function(){
             $('.login1').hide();
             $('.updatepwd').show();
          })

           $(".query").click(function(event) {
             /* Act on the event */
             var username=$('.user2').val();
             var mail=$('.mail1').val();
             $.ajax({
            url: '/thinkphp/index.php/index/updatepwd',
            type: 'post',
            dataType: 'text',
            data: 'username='+username+'&mail='+mail,
            success:function(data){
               if (data.trim()=='ok') {
                 $('.updatepwd').hide();
                 $('.updatepwd1').show();
               }else if(data.trim()=='no'){
                  alert("您输入的邮箱有错，请重新输入");
               }
               else{
                  alert('无此账号，请先注册');
               }
            }
         })
         .done(function() {
            console.log("success");
         })
         .fail(function() {
            console.log("error");
         })
         .always(function() {
            console.log("complete");
         });
             

           });

           $('.query1').click(function(event) {
             /* Act on the event */
             var username=$('.user2').val();
             var pwd1=$('.password2').val();
             var pwd2=$('.password3').val();
             if (!pwd1=='' && !pwd2=='') {
               if (pwd1==pwd2) {
                    $.ajax({
            url: '/thinkphp/index.php/index/updatepwd1',
            type: 'post',
            dataType: 'text',
            data: 'pwd='+pwd1+'&username='+username,
            success:function(data){
               if (data.trim()=='ok') {
                alert('修改成功,返回登录');
                 $('.updatepwd1').hide();
                 $('.login1').show();
               }
               else{
                  alert('修改失败');
               }
            }
         })
         .done(function() {
            console.log("success");
         })
         .fail(function() {
            console.log("error");
         })
         .always(function() {
            console.log("complete");
         });
               }else{
                alert('两次密码不一致');
               }
             }else{
              alert('密码不能为空，请重新输入');
             }
             
           });

      	   $(".button").click(function () {
             var username=$('.user').val();
             var password=$('.password').val();
             var checkbox=$('.remember').prop("checked");
            $.ajax({
              url: '/thinkphp/index.php/index/login',
              type: 'post',
              dataType: 'text',
              data: 'username='+username+'&password='+password+'&checkbox='+checkbox,
              success: function(data){  //回调函数，data为形参，是php页面返回的值
               var s= data[0]+data[1];
                if (s=='ok') {
                  alert("登陆成功");
                  window.location.href='personal.html' ;//解析成功
                }else if(s=='no'){
                  alert("密码错误");
                }else{
                  alert("无此账号");
                }
             }
             })
             .done(function() {
              console.log("success");
             })
             .fail(function() {
              console.log("error");
             })
             .always(function() {
              console.log("complete");
             });
      	   	/*var u = "w123456";
      	   	var p = 123456;
            var user =  $(".user").val();
            var password =  $(".password").val();
            if (user == "" || password == "") {
            	alert("账户或者密码为空！");
            } else if(user == u && password == p) {
            	if($(".remember").prop("checked")){
                var user = $(".user").val();
                var password = $(".password").val();

                $.cookie("remember","true",{expires:7});
                $.cookie("user",user,{expires:7 });
                $.cookie("password",password,{expires:7 });
            }else{
                $.cookie("remember","false",{expires:-1});
                $.cookie("user","",{ expires:-1 });
                $.cookie("password","",{ expires:-1 });
            }
            	if($(".remember").prop("checked")){
            		alert("登录成功,下次进入将自动填充账号密码")
            	}else{
            		alert("登录成功");
            	}
            } else {
            	alert("登录失败");
            }*/
            
      	   })
           $('.registe').click(function(){
              var username=$('.user1').val();
             var password=$('.password1').val();
             var mail=$('.mail').val();
             if (username == "" && password == "") {
              alert("账号和密码不能为空！");
             }else{
              $.ajax({
              url: '/thinkphp/index.php/index/register',
              type: 'post',
              data: 'username='+username+'&password='+password+'&mail='+mail,
              success: function(data){  //回调函数，data为形参，是从login-cl.php页面返回的值
                if (data.trim()=='ok') {
                  alert('注册成功');
                }else if(data.trim()=='no'){
                  alert('已存在该账号！');
                }else if(data.trim()=='no1'){
                  alert('邮箱不能为空');
                }else{
                  alert('注册失败');
                }
             }
             })
             .done(function() {
              console.log("success");
             })
             .fail(function() {
              console.log("error");
             })
             .always(function() {
              console.log("complete");
             });
             }
           })
    </script>
</body>
</html>